# CIFAR-10 æ™ºèƒ½è¯Šæ–­è®­ç»ƒç³»ç»Ÿä½¿ç”¨è¯´æ˜

## æ¦‚è¿°

è¿™æ˜¯åŸºäºæ•™ç¨‹ç¬¬1ç« "è®­ç»ƒé—®é¢˜è¯Šæ–­è¡¨"å’Œ"æ•°æ®æ“ä½œè¡¨"å®ç°çš„æ™ºèƒ½åŒ–è®­ç»ƒè„šæœ¬ï¼ˆé˜¶æ®µ1ç‰ˆæœ¬ï¼‰ã€‚

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- âœ… è®­ç»ƒå‰æ•°æ®è´¨é‡è‡ªåŠ¨æ£€æŸ¥ï¼ˆEDAï¼‰
- âœ… è®­ç»ƒä¸­å®æ—¶é—®é¢˜è¯Šæ–­
- âœ… è‡ªåŠ¨ç”Ÿæˆæ”¹è¿›å»ºè®®ï¼ˆä¸è‡ªåŠ¨è°ƒå‚ï¼‰
- âœ… å¯è§†åŒ–è¯Šæ–­ä»ªè¡¨ç›˜
- âœ… æ•™å­¦å‹å¥½ï¼Œé€æ˜åº¦é«˜

## å¿«é€Ÿå¼€å§‹

### 1. åŸºç¡€è®­ç»ƒï¼ˆé»˜è®¤é…ç½®ï¼‰

```bash
# Simple CNNï¼ˆæ¨èåˆå­¦è€…ï¼‰
python tutorial_runs/cifar_cnn_resnet_smart.py --model simple_cnn

# ResNet18
python tutorial_runs/cifar_cnn_resnet_smart.py --model resnet18

# å¯¹æ¯”ä¸¤ä¸ªæ¨¡å‹
python tutorial_runs/cifar_cnn_resnet_smart.py --model both
```

### 2. åº”ç”¨æ”¹è¿›å»ºè®®

å‡è®¾è®­ç»ƒåç³»ç»Ÿæç¤º"è¿‡æ‹Ÿåˆä¸¥é‡ï¼Œå»ºè®®ä½¿ç”¨æ•°æ®å¢å¼ºå’ŒL2æ­£åˆ™åŒ–"ï¼š

```bash
# åº”ç”¨å»ºè®®
python tutorial_runs/cifar_cnn_resnet_smart.py \
    --model simple_cnn \
    --data_augment True \
    --weight_decay 1e-4
```

### 3. è°ƒæ•´å­¦ä¹ ç‡

å¦‚æœç³»ç»Ÿæç¤º"Lossä¸æ”¶æ•›ï¼Œå»ºè®®é™ä½å­¦ä¹ ç‡"ï¼š

```bash
python tutorial_runs/cifar_cnn_resnet_smart.py \
    --model simple_cnn \
    --lr 1e-4
```

## åŠŸèƒ½è¯¦è§£

### ğŸ“Š è®­ç»ƒå‰æ•°æ®è´¨é‡æ£€æŸ¥

è‡ªåŠ¨æ£€æµ‹ï¼š
- âœ“ æ•°æ®é‡æ˜¯å¦å……è¶³ï¼ˆ< 5000æ ·æœ¬ä¼šè­¦å‘Šï¼‰
- âœ“ ç±»åˆ«åˆ†å¸ƒæ˜¯å¦å¹³è¡¡ï¼ˆä¸å¹³è¡¡æ¯”ä¾‹ > 3ä¼šè­¦å‘Šï¼‰
- âœ“ å›¾åƒç»Ÿè®¡é‡ï¼ˆå‡å€¼ã€æ ‡å‡†å·®ï¼‰

ç¤ºä¾‹è¾“å‡ºï¼š
```
============================================================
ğŸ“Š æ•°æ®è´¨é‡é¢„æ£€æŸ¥ï¼ˆè®­ç»ƒå‰ä¸»åŠ¨ç­–ç•¥ï¼‰
============================================================
âœ“ æ•°æ®é›†å¤§å°: 5000 æ ·æœ¬
  âš ï¸  æ•°æ®é‡åå°: 5000 < 10000
âœ“ ç±»åˆ«åˆ†å¸ƒï¼ˆé‡‡æ ·1000ä¸ªï¼‰: {...}
  âœ“ ç±»åˆ«åˆ†å¸ƒå¹³è¡¡
âœ“ å›¾åƒç»Ÿè®¡é‡ï¼ˆé‡‡æ ·100å¼ ï¼‰:
  - å‡å€¼: [0.4914, 0.4822, 0.4465]
  - æ ‡å‡†å·®: [0.2470, 0.2435, 0.2616]

------------------------------------------------------------
âš ï¸  å‘ç° 1 ä¸ªæ½œåœ¨é—®é¢˜:
   â€¢ æ•°æ®é‡åå° (5000 < 10000)

ğŸ’¡ æ”¹è¿›å»ºè®®:
   â€¢ å»ºè®®1: ä½¿ç”¨æ•°æ®å¢å¼º (RandomHorizontalFlip + RandomCrop)
============================================================
```

### ğŸ” è®­ç»ƒä¸­å®æ—¶è¯Šæ–­

åŸºäºæ•™ç¨‹è¯Šæ–­è¡¨çš„åˆ¤å®šæ ‡å‡†ï¼š

| é—®é¢˜ | åˆ¤å®šæ ‡å‡† | å»ºè®® |
|------|---------|------|
| Lossä¸ä¸‹é™ | 5ä¸ªepochålosså˜åŒ–<1% | å­¦ä¹ ç‡é™è‡³0.1å€ |
| è¿‡æ‹Ÿåˆä¸¥é‡ | train-val gap>30% | L2æ­£åˆ™åŒ–æˆ–æ•°æ®å¢å¼º |
| Losséœ‡è¡ | ç›¸é‚»epochæ³¢åŠ¨>20% | å­¦ä¹ ç‡é™è‡³0.5å€ |
| æ”¶æ•›å¤ªæ…¢ | 10ä¸ªepochåval_accå¢é•¿<5% | å­¦ä¹ ç‡å¢è‡³2å€ |
| æ¬ æ‹Ÿåˆ | train_acc<70% ä¸” val_acc<65% | å¢åŠ æ¨¡å‹å®¹é‡ |
| NaN/Inf | è®­ç»ƒä¸­æ–­ | å­¦ä¹ ç‡é™è‡³1e-5æˆ–æ¢¯åº¦è£å‰ª |

ç¤ºä¾‹è¾“å‡ºï¼š
```
============================================================
âš ï¸  è®­ç»ƒè¯Šæ–­æŠ¥å‘Š (Epoch 9)
============================================================
æ£€æµ‹åˆ° 1 ä¸ªé—®é¢˜:
  1. è¿‡æ‹Ÿåˆä¸¥é‡

ğŸ’¡ æ”¹è¿›å»ºè®®:
  â˜… å»ºè®®: L2æ­£åˆ™åŒ–(weight_decay=1e-4)æˆ–æ•°æ®å¢å¼º (å½“å‰gap=37.8%)
============================================================
```

### ğŸ“ˆ è¯Šæ–­ä»ªè¡¨ç›˜

è‡ªåŠ¨ç”Ÿæˆ5æ¿å—å¯è§†åŒ–ï¼š
1. **Lossæ›²çº¿**ï¼šè®­ç»ƒ/éªŒè¯Losså¯¹æ¯”
2. **å‡†ç¡®ç‡æ›²çº¿**ï¼šè®­ç»ƒ/éªŒè¯å‡†ç¡®ç‡å¯¹æ¯”
3. **è¿‡æ‹ŸåˆæŒ‡æ ‡**ï¼šTrain-Val Gapè¶‹åŠ¿ï¼ˆé˜ˆå€¼30%ï¼‰
4. **Lossç¨³å®šæ€§**ï¼šç›¸é‚»epochæ³¢åŠ¨ç‡ï¼ˆé˜ˆå€¼20%ï¼‰
5. **è‡ªåŠ¨è¯Šæ–­æ–‡æœ¬**ï¼šåŸºäºè§„åˆ™çš„é—®é¢˜æ€»ç»“

è¾“å‡ºæ–‡ä»¶ï¼š`output/<model>_smart/diagnostic_dashboard.png`

### ğŸ“ è¾“å‡ºæ–‡ä»¶

æ¯æ¬¡è®­ç»ƒç”Ÿæˆï¼š
```
output/<model>_smart/
â”œâ”€â”€ train_log.csv              # æ ‡å‡†è®­ç»ƒæ—¥å¿—
â”œâ”€â”€ model.pth                  # æ¨¡å‹æƒé‡
â”œâ”€â”€ training_plot.png          # åŸºç¡€è®­ç»ƒæ›²çº¿
â”œâ”€â”€ diagnostic_dashboard.png   # è¯Šæ–­ä»ªè¡¨ç›˜ â­æ–°å¢
â””â”€â”€ metrics.json              # æŒ‡æ ‡æ‘˜è¦ï¼ˆå«è¯Šæ–­ç»“æœï¼‰
```

## å‘½ä»¤è¡Œå‚æ•°

```bash
python tutorial_runs/cifar_cnn_resnet_smart.py --help
```

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| `--model` | simple_cnn | æ¨¡å‹é€‰æ‹©ï¼šsimple_cnn / resnet18 / both |
| `--epochs` | 10 | è®­ç»ƒè½®æ•° |
| `--subset` | 5000 | è®­ç»ƒé›†å¤§å° |
| `--test_subset` | 1000 | æµ‹è¯•é›†å¤§å° |
| `--batch_size` | 64 | æ‰¹æ¬¡å¤§å° |
| `--lr` | 1e-3 | å­¦ä¹ ç‡ |
| `--weight_decay` | 0.0 | L2æ­£åˆ™åŒ–ç³»æ•° |
| `--data_augment` | False | æ˜¯å¦å¯ç”¨æ•°æ®å¢å¼º |
| `--output` | None | è‡ªå®šä¹‰è¾“å‡ºç›®å½• |
| `--seed` | 42 | éšæœºç§å­ |

## å…¸å‹ä½¿ç”¨åœºæ™¯

### åœºæ™¯1ï¼šåˆå­¦è€…é¦–æ¬¡è®­ç»ƒ

```bash
# æ­¥éª¤1ï¼šé»˜è®¤é…ç½®è®­ç»ƒ
python tutorial_runs/cifar_cnn_resnet_smart.py --model simple_cnn

# æ­¥éª¤2ï¼šæŸ¥çœ‹è¯Šæ–­ç»“æœ
# æ‰“å¼€ output/simple_cnn_smart/diagnostic_dashboard.png

# æ­¥éª¤3ï¼šæ ¹æ®å»ºè®®æ”¹è¿›ï¼ˆå‡è®¾æç¤ºè¿‡æ‹Ÿåˆï¼‰
python tutorial_runs/cifar_cnn_resnet_smart.py \
    --model simple_cnn \
    --data_augment True \
    --weight_decay 1e-4 \
    --output output/simple_cnn_improved
```

### åœºæ™¯2ï¼šå¯¹æ¯”å®éªŒ

```bash
# å®éªŒAï¼šåŸºçº¿
python tutorial_runs/cifar_cnn_resnet_smart.py \
    --model simple_cnn \
    --output output/exp_baseline

# å®éªŒBï¼šæ•°æ®å¢å¼º
python tutorial_runs/cifar_cnn_resnet_smart.py \
    --model simple_cnn \
    --data_augment True \
    --output output/exp_augmentation

# å®éªŒCï¼šé™ä½å­¦ä¹ ç‡
python tutorial_runs/cifar_cnn_resnet_smart.py \
    --model simple_cnn \
    --lr 5e-4 \
    --output output/exp_lower_lr
```

### åœºæ™¯3ï¼šæ•™å­¦æ¼”ç¤º

```bash
# æ¼”ç¤ºè¿‡æ‹Ÿåˆé—®é¢˜ï¼ˆå°æ•°æ®+å¤§æ¨¡å‹ï¼‰
python tutorial_runs/cifar_cnn_resnet_smart.py \
    --model resnet18 \
    --subset 1000

# æ¼”ç¤ºæ¬ æ‹Ÿåˆé—®é¢˜ï¼ˆå¤æ‚æ•°æ®+ç®€å•æ¨¡å‹ï¼‰
python tutorial_runs/cifar_cnn_resnet_smart.py \
    --model simple_cnn \
    --subset 50000
```

## ä¸åŸç‰ˆå¯¹æ¯”

| åŠŸèƒ½ | åŸç‰ˆè„šæœ¬ | æ™ºèƒ½ç‰ˆï¼ˆé˜¶æ®µ1ï¼‰ |
|------|---------|----------------|
| åŸºç¡€è®­ç»ƒ | âœ“ | âœ“ |
| æ•°æ®è´¨é‡é¢„æ£€ | âœ— | âœ“ |
| å®æ—¶è¯Šæ–­ | âœ— | âœ“ |
| æ”¹è¿›å»ºè®® | âœ— | âœ“ |
| è¯Šæ–­ä»ªè¡¨ç›˜ | âœ— | âœ“ |
| è‡ªåŠ¨è°ƒå‚ | âœ— | âœ—ï¼ˆé˜¶æ®µ1ä¸æ”¯æŒï¼‰ |

## ç†è§£è¯Šæ–­é€»è¾‘

æ‰€æœ‰è¯Šæ–­è§„åˆ™éƒ½æ¥è‡ªæ•™ç¨‹ç¬¬1ç« çš„è¯Šæ–­è¡¨ï¼š

```python
# è¿‡æ‹Ÿåˆæ£€æµ‹
if (train_acc - val_acc) > 0.30:
    problems.append("è¿‡æ‹Ÿåˆä¸¥é‡")
    recommendations.append("L2æ­£åˆ™åŒ–æˆ–æ•°æ®å¢å¼º")

# Lossä¸æ”¶æ•›æ£€æµ‹
if max(recent_5_losses) - min(recent_5_losses) < 0.01 * max_loss:
    problems.append("Lossä¸ä¸‹é™")
    recommendations.append("å­¦ä¹ ç‡é™è‡³0.1å€")
```

## å¸¸è§é—®é¢˜

**Q: ä¸ºä»€ä¹ˆä¸è‡ªåŠ¨è°ƒå‚ï¼Ÿ**  
A: é˜¶æ®µ1æ˜¯æ•™å­¦ç‰ˆæœ¬ï¼Œé‡ç‚¹æ˜¯è®©å­¦ç”Ÿç†è§£"é—®é¢˜â†’è¯Šæ–­â†’å»ºè®®"çš„é€»è¾‘ã€‚è‡ªåŠ¨è°ƒå‚åœ¨é˜¶æ®µ2/3å®ç°ã€‚

**Q: è¯Šæ–­å»ºè®®å’Œå®é™…æƒ…å†µä¸ç¬¦æ€ä¹ˆåŠï¼Ÿ**  
A: è¯Šæ–­è¡¨æ˜¯ç»éªŒè§„åˆ™ï¼Œä¸æ˜¯ä¸‡èƒ½çš„ã€‚éœ€è¦ç»“åˆå…·ä½“æƒ…å†µåˆ†æï¼Œè¿™æ­£æ˜¯åŸ¹å…»å·¥ç¨‹åˆ¤æ–­åŠ›çš„è¿‡ç¨‹ã€‚

**Q: å¯ä»¥ä¿®æ”¹è¯Šæ–­é˜ˆå€¼å—ï¼Ÿ**  
A: å¯ä»¥ï¼åœ¨è„šæœ¬ä¸­ä¿®æ”¹ `TrainingDiagnostic` ç±»çš„åˆ¤å®šæ ‡å‡†å³å¯ã€‚

**Q: æ”¯æŒå…¶ä»–æ•°æ®é›†å—ï¼Ÿ**  
A: å½“å‰ä»…æ”¯æŒCIFAR-10ã€‚è¦æ‰©å±•åˆ°å…¶ä»–æ•°æ®é›†ï¼Œéœ€è¦ä¿®æ”¹æ•°æ®åŠ è½½éƒ¨åˆ†ã€‚

## æ‰©å±•å®éªŒå»ºè®®

1. **éªŒè¯è¯Šæ–­å‡†ç¡®æ€§**ï¼šæ•…æ„åˆ¶é€ è®­ç»ƒé—®é¢˜ï¼ˆå¦‚æé«˜å­¦ä¹ ç‡ï¼‰ï¼Œè§‚å¯Ÿè¯Šæ–­æ˜¯å¦å‡†ç¡®

2. **å¯¹æ¯”æ”¹è¿›æ•ˆæœ**ï¼šåº”ç”¨å»ºè®®å‰åçš„æ€§èƒ½å¯¹æ¯”

3. **è°ƒæ•´è¯Šæ–­é˜ˆå€¼**ï¼šä¿®æ”¹é˜ˆå€¼ï¼ˆå¦‚è¿‡æ‹Ÿåˆä»30%æ”¹ä¸º20%ï¼‰ï¼Œè§‚å¯Ÿè¯Šæ–­å˜åŒ–

4. **å¤šæ¨¡å‹å¯¹æ¯”**ï¼šä½¿ç”¨ `--model both` å¯¹æ¯”ä¸åŒæ¨¡å‹çš„è¯Šæ–­ç»“æœ

## æŠ€æœ¯ç»†èŠ‚

- **æ— è‡ªåŠ¨è°ƒå‚**ï¼šæ‰€æœ‰å‚æ•°éœ€è¦æ‰‹åŠ¨è®¾ç½®ï¼Œç¬¦åˆæ•™å­¦åœºæ™¯
- **é€æ˜åº¦é«˜**ï¼šæ‰€æœ‰è¯Šæ–­é€»è¾‘éƒ½æœ‰æ˜ç¡®è¾“å‡ºï¼Œå¯è¿½æº¯
- **å¯æ‰©å±•**ï¼šå¯ä»¥è½»æ¾æ·»åŠ æ–°çš„è¯Šæ–­è§„åˆ™
- **è½»é‡çº§**ï¼šä»…ä¾èµ–PyTorchã€torchvisionã€matplotlib

## ä¸‹ä¸€æ­¥

- é˜¶æ®µ2ï¼šåŠè‡ªåŠ¨åŒ–ï¼ˆè¯Šæ–­+äººå·¥ç¡®è®¤+è‡ªåŠ¨è°ƒå‚ï¼‰
- é˜¶æ®µ3ï¼šå…¨è‡ªåŠ¨åŒ–ï¼ˆå¤šå®éªŒå¹¶è¡Œ+æœ€ä¼˜é…ç½®æœç´¢ï¼‰

---

**ä½œè€…**ï¼šåŸºäºæ·±åº¦å­¦ä¹ ä¸æ™ºèƒ½é©¾é©¶å®è·µå·¥åŠæ•™ç¨‹  
**ç‰ˆæœ¬**ï¼š1.0ï¼ˆé˜¶æ®µ1ï¼šè¯Šæ–­+å»ºè®®ï¼‰  
**æ›´æ–°æ—¥æœŸ**ï¼š2026-01-20
